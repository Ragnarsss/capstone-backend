# ============================================================================
# Asistencia System - Environment Variables Template
# ============================================================================
# INSTRUCTIONS:
#   1. Copy this file to .env: cp .env.example .env
#   2. Update values according to your environment
#   3. Never commit .env to version control
# ============================================================================

# ----------------------------------------------------------------------------
# PostgreSQL Database Configuration
# ----------------------------------------------------------------------------
# Database name for the Asistencia system
POSTGRES_DB=asistencia_db

# PostgreSQL superuser username
POSTGRES_USER=asistencia

# PostgreSQL superuser password
# SECURITY: Change this in production!
POSTGRES_PASSWORD=asistencia_pass

# PostgreSQL host (container name in docker-compose/podman-compose)
POSTGRES_HOST=postgres

# PostgreSQL port (internal container port)
POSTGRES_PORT=5432

# PostgreSQL connection pool max connections
POSTGRES_POOL_MAX=10

# PostgreSQL idle timeout (milliseconds)
POSTGRES_IDLE_TIMEOUT=30000

# PostgreSQL connection timeout (milliseconds)
POSTGRES_CONN_TIMEOUT=5000

# ----------------------------------------------------------------------------
# Valkey/Redis Configuration
# ----------------------------------------------------------------------------
# Valkey host (container name)
VALKEY_HOST=valkey

# Valkey port (internal container port)
VALKEY_PORT=6379

# Valkey password (optional, leave empty for development)
VALKEY_PASSWORD=

# ----------------------------------------------------------------------------
# Node.js Service Configuration
# ----------------------------------------------------------------------------
# Host to bind the Node.js server
NODE_HOST=0.0.0.0

# Port for Node.js service (internal)
NODE_PORT=3000

# Node environment (development, production, test)
NODE_ENV=development

# ----------------------------------------------------------------------------
# Development & Debug Configuration
# ----------------------------------------------------------------------------
# Enable verbose logging (true/false)
ENABLE_VERBOSE_LOGS=false

# Enable stub mode for enrollment (bypass real crypto in tests)
ENROLLMENT_STUB_MODE=false

# Enable PostgreSQL persistence for attendance (true/false)
ENABLE_POSTGRES_PERSISTENCE=true

# Frontend URL for CORS
FRONTEND_URL=http://localhost:9500

# ----------------------------------------------------------------------------
# PHP Service Configuration
# ----------------------------------------------------------------------------
# External port to expose PHP/Apache service
PHP_EXTERNAL_PORT=9500

# ----------------------------------------------------------------------------
# JWT Authentication Configuration
# ----------------------------------------------------------------------------
# JWT secret key for token signing
# SECURITY: Generate a strong random key for production!
# Example: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# JWT token expiration time (e.g., 1h, 24h, 7d)
JWT_EXPIRATION=24h

# JWT issuer
JWT_ISSUER=asistencia-system

# ----------------------------------------------------------------------------
# FIDO2 / WebAuthn Configuration
# ----------------------------------------------------------------------------
# Relying Party ID (usually your domain)
WEBAUTHN_RP_ID=localhost

# Relying Party Name
WEBAUTHN_RP_NAME=Asistencia System

# Allowed origins for WebAuthn (comma-separated)
WEBAUTHN_ORIGINS=http://localhost:9500

# WebAuthn origin (single, used by SimpleWebAuthn)
WEBAUTHN_ORIGIN=http://localhost:9500

# ----------------------------------------------------------------------------
# Vite Development Server Configuration
# ----------------------------------------------------------------------------
# Vite dev server URL (for HMR proxy)
VITE_URL=http://localhost:5173

# Vite base path
VITE_BASE_PATH=/asistencia/

# Static files path (built frontend)
# STATIC_PATH=/app/dist/frontend

# ----------------------------------------------------------------------------
# Application Configuration
# ----------------------------------------------------------------------------
# Application environment (development, staging, production)
APP_ENV=development

# Enable debug mode (true/false)
DEBUG=true

# Log level (error, warn, info, debug)
LOG_LEVEL=info

# ----------------------------------------------------------------------------
# TOTP Configuration
# ----------------------------------------------------------------------------
# TOTP time window (seconds)
TOTP_WINDOW=30

# TOTP allowed variance (number of windows)
TOTP_VARIANCE=1

# ----------------------------------------------------------------------------
# Session Configuration
# ----------------------------------------------------------------------------
# Session timeout in seconds
SESSION_TIMEOUT=3600

# Maximum validation rounds per session (1-10)
MAX_VALIDATION_ROUNDS=10

# Response time threshold in milliseconds
RESPONSE_TIME_THRESHOLD=5000

# ----------------------------------------------------------------------------
# Cryptographic Configuration
# ----------------------------------------------------------------------------
# Master secret for key derivation (HKDF)
# SECURITY: Generate a strong random 32+ character string for production!
# Example: openssl rand -base64 32
SERVER_MASTER_SECRET=change_this_master_secret_in_production_32bytes

# ----------------------------------------------------------------------------
# PHP-Node Integration Module Configuration
# ----------------------------------------------------------------------------
# JWT secret for user tokens (PHP to Node communication)
# SECURITY: Generate random 32+ character string for production
JWT_SECRET=change_this_secret_in_production

# JWT secret for internal API tokens (PHP to Node backend calls)
# SECURITY: Generate different random 32+ character string for production
JWT_SECRET_INTERNAL=change_this_internal_secret_in_production

# Enable/disable Node integration module
NODE_MODULE_ENABLED=true

# ----------------------------------------------------------------------------
# AAGUID Validation Configuration (Fase 22.3)
# ----------------------------------------------------------------------------
# Enable AAGUID whitelist validation (true/false)
# When enabled, only known platform authenticators can enroll
# Disable in development to allow testing with any authenticator
AAGUID_VALIDATION_ENABLED=true

# Allow NULL AAGUID (00000000-0000-0000-0000-000000000000)
# Some authenticators don't provide attestation, returning null AAGUID
# Set to true only if you trust devices without attestation
AAGUID_ALLOW_NULL=false

# Allow unknown AAGUIDs (permissive mode)
# When true, unknown AAGUIDs are allowed with a warning log
# Useful during transition to identify missing devices in whitelist
# Set to false in production for strict security
AAGUID_ALLOW_UNKNOWN=false

